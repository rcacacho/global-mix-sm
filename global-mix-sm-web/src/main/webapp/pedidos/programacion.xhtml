<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"                
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"    
    xmlns:p="http://primefaces.org/ui"
    template="/templates/template.xhtml">    

    <f:metadata>
    </f:metadata>

    <ui:define name="pageTitle">        
        <h:outputLabel value="Registro de programación de pedido" style="float: left;"/>
    </ui:define>

    <ui:define name="content">
        <p:outputPanel class="content_centrado">

            <h:form id="form"> 
                <h:panelGrid columns="1" styleClass="panelLateralDerechoFormularioDinamico">  
                    <p:button  value="&nbsp;" title="Regresar"  
                               outcome="lista.xhtml" class="boton boton-img-24 b-gris4 icon-flecha-anterior"
                               style="background-position: 5px 3px !important; background-size: 24px 24px !important;" >                             
                    </p:button>
                </h:panelGrid> 

                <p:outputLabel value="1. Datos de la obra" 
                               class="tituloCuatro" style="margin-left: 15px" />

                <p:outputPanel >
                    <hr class="line-separator"   />
                </p:outputPanel>

                <p:panelGrid id="pgInfo" styleClass="no-border" style="width: 96%; margin-left: 30px;">
                    <p:row>       
                        <p:column>
                            <p:outputLabel value="Asesor" style="font-weight: bold;" />
                        </p:column>
                        <p:column >
                            <p:outputLabel value="Cliente" style="font-weight: bold; "/>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="Obra" style="font-weight: bold; "/>
                        </p:column>
                    </p:row>   
                    <p:row>
                        <p:column>
                            <p:selectOneMenu  value="#{programacionPedidoMB.pedido.idasesor}" style="width: 250px;" converter="entityConverter"
                                              filter="true" filterMatchMode="contains">   
                                <p:ajax event="itemSelect"/>
                                <f:selectItem itemLabel="Seleccione" itemValue="#{null}" noSelectionOption="true" /> 
                                <f:selectItems value="#{programacionPedidoMB.listAsesor}" var="asesor" itemLabel="#{asesor.nombres} #{asesor.apellidos}" itemValue="#{asesor}" />
                            </p:selectOneMenu>
                        </p:column>
                        <p:column >
                            <p:selectOneMenu  value="#{programacionPedidoMB.pedido.idcliente}" style="width: 250px;" converter="entityConverter"
                                              filter="true" filterMatchMode="contains">
                                <p:ajax event="itemSelect"/>
                                <f:selectItem itemLabel="Seleccione" itemValue="#{null}" noSelectionOption="true" /> 
                                <f:selectItems value="#{programacionPedidoMB.listClientes}" var="cliente" itemLabel="#{cliente.nombres} #{cliente.apellidos}" itemValue="#{cliente}" />
                            </p:selectOneMenu>
                        </p:column>                      
                        <p:column >
                            <p:inputText id="txtObra" value="#{programacionPedidoMB.pedido.obra}" style="width: 95%;"  placeholder="(Obra)">
                                <p:ajax event="blur" process="@this"  />
                            </p:inputText>
                        </p:column>   
                    </p:row>      
                    <p:row>
                        <p:column >
                            <p:outputLabel value="Tipo pago" style="font-weight: bold;"/>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="Cantidad pagada" style="font-weight: bold;"/>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="Elemento" style="font-weight: bold;"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:selectOneMenu  value="#{programacionPedidoMB.pedido.idtipopago}" style="width: 250px;" converter="entityConverter"
                                              filter="true" filterMatchMode="contains">    
                                <p:ajax event="itemSelect"/>
                                <f:selectItem itemLabel="Seleccione" itemValue="#{null}" noSelectionOption="true" /> 
                                <f:selectItems value="#{programacionPedidoMB.listTipoPago}" var="tipo" itemLabel="#{tipo.tipopago}" itemValue="#{tipo}" />
                            </p:selectOneMenu>
                        </p:column>
                        <p:column>
                            <p:inputText id="txtCantidad" value="#{programacionPedidoMB.pedido.cantidadpagada}" style="width: 95%;"  placeholder="(Cantidad pagada)">
                                <p:ajax event="blur" process="@this"  />
                            </p:inputText>
                        </p:column>
                        <p:column>
                            <p:inputText id="txtElemento" value="#{programacionPedidoMB.pedido.elemento}" style="width: 95%;"  placeholder="(Elemento)">
                                <p:ajax event="blur" process="@this"  />
                            </p:inputText>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Volumen" style="font-weight: bold;"/>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="Fraguado" style="font-weight: bold;"/>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="Frec" style="font-weight: bold;"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:inputText id="txtVolumen" value="#{programacionPedidoMB.pedido.volumen}" style="width: 95%;"  placeholder="(Volumen)">
                                <p:ajax event="blur" process="@this"  />
                            </p:inputText>
                        </p:column>
                        <p:column>
                            <p:inputText id="txtFraguado" value="#{programacionPedidoMB.pedido.fraguado}" style="width: 95%;"  placeholder="(Fraguado)">
                                <p:ajax event="blur" process="@this"  />
                            </p:inputText>
                        </p:column>
                        <p:column>
                            <p:inputText id="txtFrec" value="#{programacionPedidoMB.pedido.frec}" style="width: 95%;"  placeholder="(Frec)">
                                <p:ajax event="blur" process="@this"  />
                            </p:inputText>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Bombeo" style="font-weight: bold;"/>
                        </p:column>
                        <p:column>
                            <p:outputLabel value="Dir/Bomb." style="font-weight: bold;"/>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="Tuberia" style="font-weight: bold;"/>
                        </p:column>                        
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:selectOneMenu  value="#{programacionPedidoMB.pedido.bombeo}" style="width:250px;" 
                                              filter="true" filterMatchMode="contains">
                                <p:ajax event="itemSelect"/>
                                <f:selectItem itemLabel="(Seleccione)" itemValue="" noSelectionOption="true" />
                                <f:selectItem itemLabel="Si" itemValue="Si" />
                                <f:selectItem itemLabel="No" itemValue="No" />
                            </p:selectOneMenu>
                        </p:column>           
                        <p:column>
                            <p:inputText id="txtDir" value="#{programacionPedidoMB.pedido.dirbom}" style="width: 95%;"  placeholder="(Dir/Bomb.)">
                                <p:ajax event="blur" process="@this"  />
                            </p:inputText> 
                        </p:column>
                        <p:column>
                            <p:inputText id="txtTuberia" value="#{programacionPedidoMB.pedido.tuberia}" style="width: 95%;"  placeholder="(tuberia)">
                                <p:ajax event="blur" process="@this"  />
                            </p:inputText>                             
                        </p:column>                  
                    </p:row>
                </p:panelGrid>

                <p:panelGrid id="pgConcreto" styleClass="no-border" style="width: 84%; margin-left: 30px;">
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Concreto" style="font-weight: bold;"/>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="Extras" style="font-weight: bold;"/>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="" style="font-weight: bold;"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:selectOneMenu id="somTipoCem" value="#{programacionPedidoMB.pedido.idtipocemento}" style="width: 250px;" converter="entityConverter"
                                             filter="true" filterMatchMode="contains">   
                                <p:ajax event="itemSelect"/>
                                <f:selectItem itemLabel="Seleccione" itemValue="#{null}" noSelectionOption="true" /> 
                                <f:selectItems value="#{programacionPedidoMB.listTipoCemento}" var="tipo" itemLabel="#{tipo.descripcion}" itemValue="#{tipo}" />
                            </p:selectOneMenu>

                            <p:commandButton id="btnAgregar" value="" title="Registro" onstart="start();" oncomplete="stop();" 
                                             actionListener="#{programacionPedidoMB.abrirTipoCemento()}" immediate="true"
                                             update="somTipo"  style="background-position: 5px 3px !important; 
                                             background-size: 18px 18px !important; margin-left: 5px;"
                                             class="boton boton-img-24 b-gris4 icon-agregar-archivo" process="@this">
                            </p:commandButton>
                        </p:column>
                        <p:column>
                            <p:inputText id="txtExtra" value="#{programacionPedidoMB.pedido.extraconcreto}" style="width: 368px;"  placeholder="(Extra)">
                                <p:ajax event="blur" process="@this"  />
                            </p:inputText>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="" style="font-weight: bold;"/>
                        </p:column>
                    </p:row>
                </p:panelGrid>

                <p:panelGrid id="pgColocado" styleClass="no-border" style="width: 96%; margin-left: 30px;">
                    <p:row>
                        <p:column >
                            <p:outputLabel value="Colocado" style="font-weight: bold;"/>
                        </p:column>
                        <p:column>
                            <p:outputLabel value="Tipo colocado" rendered="#{programacionPedidoMB.mostrarColocado}" style="font-weight: bold;"/>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="Colocador" rendered="#{programacionPedidoMB.mostrarColocado}" style="font-weight: bold;"/>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="Cantidad cobrada en colocado" rendered="#{programacionPedidoMB.mostrarColocado}" style="font-weight: bold;"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:selectOneMenu  value="#{programacionPedidoMB.pedido.colocado}" style="width:250px;" 
                                              filter="true" filterMatchMode="contains">
                                <p:ajax event="itemSelect"/>
                                <p:ajax listener="#{programacionPedidoMB.cargarColocado()}" update=":form:pgColocado"/>
                                <f:selectItem itemLabel="(Seleccione)" itemValue="" noSelectionOption="true" />
                                <f:selectItem itemLabel="Si" itemValue="Si"  />
                                <f:selectItem itemLabel="No" itemValue="No" />
                            </p:selectOneMenu>
                        </p:column>
                        <p:column >
                            <p:selectOneMenu id="somTipo" value="#{programacionPedidoMB.pedido.tipocolocado}" style="width:250px;" 
                                             filter="true" filterMatchMode="contains" rendered="#{programacionPedidoMB.mostrarColocado}">
                                <p:ajax event="itemSelect"/>
                                <f:selectItem itemLabel="(Seleccione)" itemValue="" noSelectionOption="true" />
                                <f:selectItem itemLabel="M|2" itemValue="M|2" />
                                <f:selectItem itemLabel="M|3" itemValue="M|3" />
                            </p:selectOneMenu>
                        </p:column>
                        <p:column >
                            <p:inputText id="txtColocador" value="#{programacionPedidoMB.pedido.colocador}" style="width: 95%;"  placeholder="(Colocador)"
                                         rendered="#{programacionPedidoMB.mostrarColocado}">
                                <p:ajax event="blur" process="@this"  />
                            </p:inputText>
                        </p:column>
                        <p:column>
                            <p:inputText id="txtCobro" value="#{programacionPedidoMB.pedido.cantidadcobradacolocado}" style="width: 95%;"  placeholder="(cantidad)"
                                         rendered="#{programacionPedidoMB.mostrarColocado}">
                                <p:ajax event="blur" process="@this"  />
                            </p:inputText>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column >
                            <p:outputLabel value="Laboratorio" style="font-weight: bold;"/>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="Fecha y hora del envío" style="font-weight: bold;"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:inputText id="txtLabo" value="#{programacionPedidoMB.pedido.laboratorio}" style="width: 95%;"  placeholder="(laboratorio)">
                                <p:ajax event="blur" process="@this"  />
                            </p:inputText>
                        </p:column>
                        <p:column>
                            <p:calendar id="fInicial" placeholder="(elige una fecha)" locale="es" timeZone="America/Guatemala" pattern="dd/MM/yyyy HH:mm" 
                                        mask="99/99/9999 99:99" value="#{programacionPedidoMB.pedido.fechapedido}" navigator="true" timeControlType="select">  
                                <p:ajax event="dateSelect" process="@this" />
                            </p:calendar>
                        </p:column>
                    </p:row>
                </p:panelGrid>        

                <div align="right" style="width: 100%; margin-bottom: 15px; margin-top: 15px; width: 98%" >
                    <table >
                        <tr>                                       
                            <td>
                                <p:commandButton value="Guardar" 
                                                 class="boton boton-imgtxt-16 b-gris4 icon-guardar" process="@this"
                                                 style="float: right; margin-right: 10px; margin-bottom: 10px; margin-top: 10px"       
                                                 action="#{programacionPedidoMB.registroPedido()}" onstart="start();" oncomplete="stop();"
                                                 update="@form"/>
                            </td>
                            <td>
                                <p:commandButton value="Cancelar" 
                                                 class="boton boton-imgtxt-16 b-gris4 icon-cancelar-cerrar "
                                                 actionListener="#{programacionPedidoMB.limpiarCampos()}"
                                                 style="background-position: 5px 3px !important; background-size: 16px 16px !important;"
                                                 update="@all" immediate="true"/>
                            </td>
                        </tr>
                    </table>
                </div>

                <p:dialog widgetVar="dlgRegistro" id="dlgRegistro" showEffect="clip" hideEffect="clip" header="Registro de concreto"
                          resizable="false" draggable="false" closable="true" modal="true" width="550px" position="top">

                    <p:panelGrid id="pginfo" columns="1" styleClass="no-border" style="width: 100%; margin-top: 10px;">
                        <p:outputLabel value="Descripción:" style="font-weight: bold;" />              

                        <p:inputText value="#{programacionPedidoMB.tipoCemento.descripcion}" style="width: 520px;"  
                                     placeholder="(ingrese una descripción)">
                            <p:ajax event="blur" process="@this"  />
                        </p:inputText>                            
                    </p:panelGrid> 

                    <p:commandButton value="Cancelar" process="@this" 
                                     style="float: right; margin-right: 10px; margin-bottom: 10px; margin-top: 10px"
                                     class="boton boton-imgtxt-16 b-gris4 icon-cancelar-cerrar"
                                     onclick="PF('dlgRegistro').hide();"/>

                    <p:commandButton value="Guardar" process="@this" immediate="true"
                                     class="boton boton-imgtxt-16 b-gris4 icon-guardar"
                                     style="float: right; margin-right: 10px; margin-bottom: 10px; margin-top: 10px"       
                                     action="#{programacionPedidoMB.registrarTipoCemento()}" onstart="start();" oncomplete="stop();"
                                     update=":form:pgConcreto"/>
                </p:dialog>
            </h:form>
        </p:outputPanel>
    </ui:define>
</ui:composition>